<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sticker Book Template ‚Äî Showcase</title>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Permanent+Marker&family=Work+Sans:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --paper: #f5f0e6;
            --ink: #1a1a1a;
            --pink: #ff6b9d;
            --blue: #0078bf;
            --green: #00a95c;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Courier Prime', monospace;
            background: var(--paper);
            color: var(--ink);
            line-height: 1.7;
        }
        
        /* Grain overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
            z-index: 10000;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 60px 30px;
        }
        
        /* Header */
        .header {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .header h1 {
            font-family: 'Permanent Marker', cursive;
            font-size: 3rem;
            transform: rotate(-2deg);
            margin-bottom: 15px;
        }
        
        .header h1 span {
            color: var(--pink);
        }
        
        .header .tagline {
            font-size: 1.2rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Demo callout */
        .demo-callout {
            background: var(--pink);
            color: white;
            padding: 20px 30px;
            text-align: center;
            transform: rotate(-1deg);
            margin: 40px 0;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.1);
        }
        
        .demo-callout p {
            font-size: 1.1rem;
            margin: 0;
        }
        
        .demo-callout strong {
            font-family: 'Permanent Marker', cursive;
        }
        
        /* Section */
        .section {
            margin: 50px 0;
        }
        
        .section h2 {
            font-family: 'Work Sans', sans-serif;
            font-weight: 800;
            font-size: 1.5rem;
            text-transform: uppercase;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section h2::before {
            content: '';
            width: 12px;
            height: 12px;
            background: var(--pink);
        }
        
        /* Feature grid */
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature {
            background: white;
            border: 2px solid var(--ink);
            padding: 25px;
            position: relative;
        }
        
        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .feature h3 {
            font-family: 'Work Sans', sans-serif;
            font-weight: 700;
            font-size: 1rem;
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        
        .feature p {
            font-size: 0.9rem;
            color: #555;
        }
        
        /* Code block */
        .code-section {
            background: var(--ink);
            color: #f8f8f2;
            padding: 25px;
            margin: 30px 0;
            overflow-x: auto;
        }
        
        .code-section h3 {
            color: var(--pink);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 15px;
        }
        
        .code-section pre {
            font-family: 'Courier Prime', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-word;
        }
        
        .code-section .comment {
            color: #6272a4;
        }
        
        .code-section .string {
            color: #f1fa8c;
        }
        
        .code-section .key {
            color: #8be9fd;
        }
        
        /* Customization table */
        .customize-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9rem;
        }
        
        .customize-table th,
        .customize-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .customize-table th {
            background: var(--ink);
            color: white;
            font-family: 'Work Sans', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.8rem;
        }
        
        .customize-table tr:nth-child(even) {
            background: rgba(0,0,0,0.03);
        }
        
        .customize-table code {
            background: #eee;
            padding: 2px 6px;
            font-size: 0.85rem;
        }
        
        /* CTA */
        .cta {
            text-align: center;
            padding: 50px 30px;
            background: white;
            border: 3px solid var(--ink);
            margin: 50px 0;
        }
        
        .cta h2 {
            font-family: 'Permanent Marker', cursive;
            font-size: 2rem;
            margin-bottom: 15px;
        }
        
        .cta p {
            color: #666;
            margin-bottom: 25px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .btn {
            display: inline-block;
            font-family: 'Work Sans', sans-serif;
            font-weight: 700;
            font-size: 1rem;
            text-transform: uppercase;
            padding: 15px 35px;
            background: var(--pink);
            color: white;
            text-decoration: none;
            border: 3px solid var(--pink);
            transition: all 0.2s;
        }
        
        .btn:hover {
            background: white;
            color: var(--pink);
        }
        
        .btn-secondary {
            background: white;
            color: var(--ink);
            border-color: var(--ink);
            margin-left: 15px;
        }
        
        .btn-secondary:hover {
            background: var(--ink);
            color: white;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 40px 0;
            border-top: 2px dashed #ccc;
            margin-top: 60px;
            color: #888;
            font-size: 0.9rem;
        }
        
        .footer a {
            color: var(--pink);
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            .header h1 { font-size: 2rem; }
            .container { padding: 40px 20px; }
            .btn { display: block; margin: 10px 0; }
            .btn-secondary { margin-left: 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        
        <header class="header">
            <h1>Sticker Book <span>Template</span></h1>
            <p class="tagline">A quiz-gated gamification system for eLearning. Learners prove what they learned to earn stickers. No paid tools required.</p>
        </header>
        
        <div class="demo-callout">
            <p><strong>üëâ Try it now!</strong> Click the pink "Stickers" tab on the right side of this page.</p>
        </div>
        
        <section class="section">
            <h2>Features</h2>
            <div class="features">
                <div class="feature">
                    <div class="feature-icon">üèÜ</div>
                    <h3>Quiz Gating</h3>
                    <p>Learners must answer a question correctly to earn each sticker. No freebies.</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">üîí</div>
                    <h3>Sequential Unlock</h3>
                    <p>Must complete stickers in order. No skipping ahead.</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">‚è≥</div>
                    <h3>Time Delays</h3>
                    <p>Configurable cooldown between stickers prevents speedrunning.</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">üéØ</div>
                    <h3>Lesson Targeting</h3>
                    <p>Only shows on specific pages. Handles SPA navigation.</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">üéâ</div>
                    <h3>Celebrations</h3>
                    <p>Confetti, sound effects, and a special unlock when complete.</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">üñ®Ô∏è</div>
                    <h3>Printable Certificate</h3>
                    <p>Learners can print their completed collection.</p>
                </div>
            </div>
        </section>
        
        <section class="section">
            <h2>How It Works</h2>
            <p>The sticker book uses <strong>localStorage</strong> to persist progress across sessions. It polls every 500ms to detect page changes (important for single-page apps like Articulate Rise). When the target lesson is detected, it shows; otherwise, it hides.</p>
            <p style="margin-top: 15px;">This architecture means the code loads globally but only appears where you want it.</p>
        </section>
        
        <section class="section">
            <h2>What You Can Customize</h2>
            <table class="customize-table">
                <thead>
                    <tr>
                        <th>Setting</th>
                        <th>What It Does</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>STICKERS</code></td>
                        <td>Add/remove stickers, set images, write quiz questions</td>
                    </tr>
                    <tr>
                        <td><code>TARGET_LESSON</code></td>
                        <td>Page title where sticker book appears (empty = all pages)</td>
                    </tr>
                    <tr>
                        <td><code>TIME_DELAY_MINUTES</code></td>
                        <td>Cooldown between earning stickers (0 = no delay)</td>
                    </tr>
                    <tr>
                        <td><code>BRANDING</code></td>
                        <td>All text: title, instructions, completion messages</td>
                    </tr>
                    <tr>
                        <td><code>COLORS</code></td>
                        <td>Primary color, success, error, backgrounds</td>
                    </tr>
                    <tr>
                        <td><code>COMPLETION_IMAGE</code></td>
                        <td>Image shown when all stickers collected</td>
                    </tr>
                    <tr>
                        <td><code>STORAGE_KEY</code></td>
                        <td>Change for separate tracking on same domain</td>
                    </tr>
                </tbody>
            </table>
        </section>
        
        <section class="section">
            <h2>Adding Your Own Stickers</h2>
            <div class="code-section">
                <h3>Example Sticker Configuration</h3>
<pre>{
  <span class="key">id</span>: <span class="string">'communication'</span>,           <span class="comment">// Unique ID (lowercase, no spaces)</span>
  <span class="key">name</span>: <span class="string">'Communication'</span>,          <span class="comment">// Display name</span>
  <span class="key">image</span>: <span class="string">'https://your-url.com/sticker.png'</span>,  <span class="comment">// Sticker image URL</span>
  <span class="key">quiz</span>: {
    <span class="key">question</span>: <span class="string">"What's the best way to start a presentation?"</span>,
    <span class="key">answers</span>: {
      <span class="key">a</span>: <span class="string">'Read directly from your slides'</span>,
      <span class="key">b</span>: <span class="string">'Start with a compelling hook or story'</span>,  <span class="comment">// Correct!</span>
      <span class="key">c</span>: <span class="string">'Introduce yourself for 5 minutes'</span>,
      <span class="key">d</span>: <span class="string">'Show your agenda slide first'</span>
    },
    <span class="key">correctAnswer</span>: <span class="string">'b'</span>
  }
}</pre>
            </div>
        </section>
        
        <section class="section">
            <h2>Works With</h2>
            <p>This template works with any platform that supports custom HTML/JavaScript:</p>
            <ul style="margin: 15px 0 0 25px; line-height: 2;">
                <li><strong>Articulate Rise + Mighty</strong> ‚Äî Global JS snippet</li>
                <li><strong>Storyline / Captivate</strong> ‚Äî Web object or JavaScript trigger</li>
                <li><strong>Canvas / Moodle / Blackboard</strong> ‚Äî HTML embed</li>
                <li><strong>WordPress / Webflow</strong> ‚Äî Custom code block</li>
                <li><strong>Plain HTML pages</strong> ‚Äî Script tag</li>
            </ul>
        </section>
        
        <div class="cta">
            <h2>Ready to Use It?</h2>
            <p>Download the template, customize the configuration section at the top, and add it to your course.</p>
            <a href="sticker-book-template.js" download class="btn">Download Template</a>
            <a href="https://emilygreendesign.com" class="btn btn-secondary" target="_blank">View Full Course</a>
        </div>
        
        <section class="section">
            <h2>Testing Commands</h2>
            <p>Open your browser console and use these commands:</p>
            <div class="code-section">
                <h3>Console Commands</h3>
<pre><span class="comment">// Reset all progress (start fresh)</span>
resetStickerBook()

<span class="comment">// Check what's in localStorage</span>
localStorage.getItem('sticker_book_v1')</pre>
            </div>
        </section>
        
        <footer class="footer">
            <p>Created by <a href="https://emilygreendesign.com" target="_blank">Emily Green</a> | Part of <a href="#">The People's Professors</a> capstone project</p>
            <p style="margin-top: 10px;">Built with trial, error, and a lot of "vibe coding" üé∏</p>
        </footer>
        
    </div>
    
    <!-- Load the sticker book (with demo content) -->
    <script>
    // Demo configuration - shows on all pages
    (function () {

    var TIME_DELAY_MINUTES = 0; // No delay for demo

    var TARGET_LESSON = ''; // Empty = show on all pages

    var STICKERS = [
      {
        id: 'hook',
        name: 'Hook',
        image: 'https://i.ibb.co/Wvc6twz6/hook.png',
        quiz: {
          question: "Which opening line uses a strong hook?",
          answers: {
            a: '"Welcome to my channel! Don\'t forget to subscribe."',
            b: '"In this video, I\'ll cover three topics about email management."',
            c: '"You\'re spending 2 hours a day on emails that should take 20 minutes."',
            d: '"Let me introduce myself before we get started."'
          },
          correctAnswer: 'c'
        }
      },
      {
        id: 'chunking',
        name: 'Chunking',
        image: 'https://i.ibb.co/KjYdRPKC/chunking.png',
        quiz: {
          question: "A 60-second nano-learning video should:",
          answers: {
            a: 'Cover as many related topics as possible to maximize value',
            b: 'Focus on one concept that the learner can immediately apply',
            c: 'Include a comprehensive overview before diving into details',
            d: 'Save the main point for the end to keep viewers watching'
          },
          correctAnswer: 'b'
        }
      },
      {
        id: 'visual_attention',
        name: 'Visual Attention',
        image: 'https://i.ibb.co/LX1BvfBH/visual-attention.png',
        quiz: {
          question: "When should text appear on screen in a nano-learning video?",
          answers: {
            a: 'Throughout the entire video so viewers can read along',
            b: 'Only at the beginning and end for titles and CTAs',
            c: 'At key moments to reinforce‚Äînot repeat‚Äîwhat\'s being said',
            d: 'Never‚Äîtext competes with visuals and should be avoided'
          },
          correctAnswer: 'c'
        }
      }
    ];

    var BRANDING = {
      tabText: 'Stickers',
      bookTitle: 'My Sticker Collection',
      bookSubtitle: 'Demo Course',
      instructions: 'Tap a slot and prove what you learned!',
      footerText: 'Collect them all to unlock a special reward!',
      completeBadge: 'COMPLETE! ‚≠ê',
      unlockTitle: 'üéâ You Did It!',
      unlockMessage: 'You\'ve mastered all the content. Congratulations!',
      certificateTitle: 'Certificate of Completion',
      certificateText: 'This certifies successful completion of all assessments.',
      certificateFooter: 'Congratulations!'
    };

    var COMPLETION_IMAGE = '';

    var COLORS = {
      primary: '#ff6b9d',
      primaryHover: '#d64d65',
      success: '#4CAF50',
      error: '#e85d75',
      background: '#f5f0e6',
      panelBg: '#e8e0d5',
      text: '#2a2a2a',
      textLight: '#666',
      textMuted: '#999',
      border: '#ccc'
    };

    var STORAGE_KEY = 'sticker_book_demo_v1';
    var CELEBRATED_KEY = 'sticker_book_demo_celebrated_v1';
    var LAST_CLAIM_KEY = 'sticker_book_demo_last_claim_v1';

    // === REST OF CODE (same as template) ===
    
    var currentQuizSticker = null;
    var cooldownTimer = null;

    var css = `
    .pp-tab{position:fixed;right:0;top:50%;transform:translateY(-50%);z-index:99999;cursor:pointer;transition:transform .3s}
    .pp-tab:hover{transform:translateY(-50%) translateX(-5px)}
    .pp-tab-inner{background:${COLORS.primary};padding:15px 12px 15px 18px;display:flex;flex-direction:column;align-items:center;gap:6px;box-shadow:-3px 3px 10px rgba(0,0,0,.2);clip-path:polygon(8px 0%,100% 0%,100% 100%,8px 100%,5px 97%,8px 94%,3px 90%,7px 86%,4px 82%,8px 78%,5px 74%,7px 70%,3px 66%,8px 62%,4px 58%,7px 54%,5px 50%,8px 46%,3px 42%,7px 38%,5px 34%,8px 30%,4px 26%,7px 22%,3px 18%,8px 14%,5px 10%,7px 6%,4px 3%)}
    .pp-tab-icon{font-size:1.5rem}
    .pp-tab-text{font-family:'Permanent Marker',cursive;font-size:.7rem;color:#fff;writing-mode:vertical-rl;letter-spacing:1px}
    .pp-tab-badge{background:#fff;color:${COLORS.primary};font-size:.6rem;font-weight:700;padding:3px 5px;border-radius:8px}
    .pp-tab-badge.complete{background:${COLORS.success};color:#fff}
    .pp-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:100000;opacity:0;visibility:hidden;transition:opacity .3s}
    .pp-overlay.open{opacity:1;visibility:visible}
    .pp-panel{position:absolute;right:0;top:0;bottom:0;width:100%;max-width:480px;background:${COLORS.panelBg};transform:translateX(100%);transition:transform .4s cubic-bezier(.4,0,.2,1);display:flex;flex-direction:column;overflow-y:auto;padding:30px 25px}
    .pp-overlay.open .pp-panel{transform:translateX(0)}
    .pp-panel-edge{position:absolute;left:0;top:0;bottom:0;width:15px;background:${COLORS.panelBg};clip-path:polygon(100% 0%,100% 100%,0% 100%,3px 97%,0% 94%,5px 91%,2px 88%,4px 85%,0% 82%,3px 79%,1px 76%,5px 73%,2px 70%,4px 67%,0% 64%,3px 61%,1px 58%,5px 55%,2px 52%,4px 49%,0% 46%,3px 43%,1px 40%,5px 37%,2px 34%,4px 31%,0% 28%,3px 25%,1px 22%,5px 19%,2px 16%,4px 13%,0% 10%,3px 7%,1px 4%,4px 1%,0% 0%);box-shadow:-3px 0 8px rgba(0,0,0,.1)}
    .pp-close{margin-top:20px;padding:14px 28px;background:transparent;border:2px dashed ${COLORS.border};border-radius:8px;font-family:'Courier Prime',monospace;font-size:1rem;color:${COLORS.textLight};cursor:pointer;align-self:center}
    .pp-close:hover{border-color:${COLORS.primary};color:${COLORS.primary}}
    .pp-book{font-family:'Courier Prime',monospace;background:${COLORS.background};border-radius:8px;padding:30px 30px 30px 55px;position:relative;box-shadow:0 2px 4px rgba(0,0,0,.1),0 8px 24px rgba(0,0,0,.12)}
    .pp-spiral{position:absolute;left:18px;top:25px;bottom:25px;width:22px;display:flex;flex-direction:column;justify-content:space-between}
    .pp-ring{width:22px;height:22px;border:3px solid ${COLORS.text};border-radius:50%;background:linear-gradient(135deg,#888,#aaa 50%,#888)}
    .pp-header{text-align:center;margin-bottom:25px;padding-bottom:15px;border-bottom:2px dashed ${COLORS.border}}
    .pp-title{font-family:'Permanent Marker',cursive;font-size:1.8rem;color:${COLORS.text};transform:rotate(-1deg);margin:0}
    .pp-subtitle{font-size:1.15rem;color:${COLORS.textLight};margin-top:8px}
    .pp-instructions{font-size:1rem;color:${COLORS.textMuted};margin-top:10px;font-style:italic}
    .pp-progress{font-size:1.1rem;color:${COLORS.textMuted};margin-top:12px;font-weight:700}
    .pp-progress span{color:${COLORS.primary};font-size:1.4rem}
    .pp-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px}
    .pp-slot{display:flex;flex-direction:column;align-items:center;gap:8px}
    .pp-box{aspect-ratio:1;width:100%;display:flex;align-items:center;justify-content:center;border-radius:12px;overflow:hidden}
    .pp-slot.empty .pp-box{background:radial-gradient(ellipse at center,rgba(0,0,0,.04) 0%,transparent 70%);border:2px dashed ${COLORS.border};cursor:pointer;transition:all .2s}
    .pp-slot.empty .pp-box:hover{border-color:${COLORS.primary};background:radial-gradient(ellipse at center,rgba(232,93,117,.08) 0%,transparent 70%)}
    .pp-slot.empty.locked .pp-box{cursor:not-allowed;opacity:.6}
    .pp-slot.empty.locked .pp-box:hover{border-color:${COLORS.border};background:radial-gradient(ellipse at center,rgba(0,0,0,.04) 0%,transparent 70%)}
    .pp-box-inner{display:flex;flex-direction:column;align-items:center;gap:4px;padding:8px;text-align:center}
    .pp-box-icon{font-size:2.2rem;opacity:.4}
    .pp-slot.empty:hover .pp-box-icon{opacity:.7}
    .pp-box-text{font-size:.8rem;color:${COLORS.textMuted};font-weight:700;text-transform:uppercase}
    .pp-slot.empty:hover .pp-box-text{color:${COLORS.primary}}
    .pp-slot.collected .pp-box{animation:stickerPlace .4s ease-out}
    .pp-slot.collected .pp-box img{width:100%;height:100%;object-fit:contain;filter:drop-shadow(2px 3px 4px rgba(0,0,0,.2));transition:transform .2s}
    .pp-slot.collected:hover .pp-box img{transform:scale(1.08) rotate(-3deg)}
    @keyframes stickerPlace{0%{transform:scale(1.3) rotate(10deg);opacity:0}60%{transform:scale(.95) rotate(-2deg)}100%{transform:scale(1) rotate(0deg);opacity:1}}
    .pp-label{font-size:.9rem;font-weight:700;text-transform:uppercase;text-align:center}
    .pp-slot.empty .pp-label{color:#bbb}
    .pp-slot.collected .pp-label{color:${COLORS.textLight}}
    .pp-doodle{position:absolute;font-size:1.2rem;opacity:.15}
    .pp-doodle-1{top:50px;right:20px;transform:rotate(15deg)}
    .pp-doodle-2{bottom:70px;right:25px;transform:rotate(-10deg)}
    .pp-doodle-3{bottom:35px;left:60px;transform:rotate(5deg)}
    .pp-footer{margin-top:25px;padding-top:15px;border-top:2px dashed ${COLORS.border};text-align:center}
    .pp-footer-text{font-size:1rem;color:${COLORS.textMuted};font-style:italic}
    .pp-cooldown{font-size:1rem;color:${COLORS.primary};margin-top:8px;font-weight:700;display:none}
    .pp-complete-badge{display:none;position:absolute;top:-8px;right:-8px;background:${COLORS.primary};color:#fff;font-family:'Permanent Marker',cursive;padding:8px 15px;border-radius:4px;transform:rotate(12deg);box-shadow:2px 3px 8px rgba(0,0,0,.2);font-size:.85rem;z-index:5}
    .pp-book.all-collected .pp-complete-badge{display:block;animation:badgePop .5s ease-out}
    @keyframes badgePop{0%{transform:rotate(12deg) scale(0)}60%{transform:rotate(12deg) scale(1.2)}100%{transform:rotate(12deg) scale(1)}}
    .pp-quiz{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);z-index:100002;display:none;align-items:center;justify-content:center;padding:20px;box-sizing:border-box}
    .pp-quiz.open{display:flex}
    .pp-quiz-box{background:${COLORS.background};border-radius:12px;width:95%;max-width:650px;padding:30px;position:relative;box-shadow:0 10px 40px rgba(0,0,0,.3);animation:quizPop .3s ease-out}
    @keyframes quizPop{0%{transform:scale(.9);opacity:0}100%{transform:scale(1);opacity:1}}
    .pp-quiz-close{position:absolute;top:12px;right:15px;background:none;border:none;color:${COLORS.textMuted};font-size:1.8rem;cursor:pointer;line-height:1}
    .pp-quiz-close:hover{color:${COLORS.primary}}
    .pp-quiz-instruction{font-size:.85rem;color:${COLORS.textMuted};margin:0 0 15px;font-family:'Courier Prime',monospace}
    .pp-quiz-question{font-family:'Courier Prime',monospace;font-size:1.1rem;color:${COLORS.text};padding:18px;background:#fff;border:2px solid ${COLORS.text};border-radius:8px;margin-bottom:18px;line-height:1.5}
    .pp-quiz-answers{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .pp-quiz-answer{position:relative;background:#fff;border:2px solid ${COLORS.text};border-radius:8px;padding:14px 14px 14px 42px;cursor:pointer;transition:all .2s;font-family:'Courier Prime',monospace;font-size:.9rem;line-height:1.4;text-align:left}
    .pp-quiz-answer:hover{border-color:${COLORS.primary};background:#fff5f5}
    .pp-quiz-letter{position:absolute;left:-2px;top:-2px;width:28px;height:28px;background:#f4d03f;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.8rem;color:${COLORS.text}}
    .pp-quiz-answer.correct{border-color:${COLORS.success};background:#e8f5e9}
    .pp-quiz-answer.correct .pp-quiz-letter{background:${COLORS.success};color:#fff}
    .pp-quiz-answer.incorrect{border-color:${COLORS.error};background:#ffebee;animation:shake .4s ease}
    @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}75%{transform:translateX(4px)}}
    .pp-quiz-feedback{margin-top:18px;padding:14px;border-radius:8px;text-align:center;font-family:'Courier Prime',monospace;font-size:1rem;display:none}
    .pp-quiz-feedback.show{display:block}
    .pp-quiz-feedback.correct{background:#e8f5e9;color:#2e7d32}
    .pp-quiz-feedback.incorrect{background:#ffebee;color:#c62828}
    .pp-confetti{position:absolute;top:0;left:0;right:0;bottom:0;pointer-events:none;overflow:hidden;border-radius:12px}
    .pp-confetti-piece{position:absolute;opacity:0}
    @keyframes confettiFall{0%{transform:translateY(-10px) rotate(0);opacity:1}100%{transform:translateY(250px) rotate(720deg);opacity:0}}
    .pp-unlock{display:none;margin-top:25px}
    .pp-book.all-collected .pp-unlock{display:block;animation:unlockReveal .6s ease-out .3s both}
    @keyframes unlockReveal{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}
    .pp-unlock-divider{text-align:center;margin-bottom:20px;position:relative}
    .pp-unlock-divider::before,.pp-unlock-divider::after{content:'';position:absolute;top:50%;width:25%;height:2px;background:linear-gradient(90deg,transparent,${COLORS.primary},transparent)}
    .pp-unlock-divider::before{left:0}
    .pp-unlock-divider::after{right:0}
    .pp-unlock-divider span{background:${COLORS.background};padding:0 15px;font-family:'Permanent Marker',cursive;font-size:.9rem;color:${COLORS.primary}}
    .pp-unlock-content{background:linear-gradient(135deg,#fff9e6,#fff5f5);border:2px solid ${COLORS.primary};border-radius:12px;padding:25px 20px;text-align:center}
    .pp-unlock-title{font-family:'Permanent Marker',cursive;font-size:1.7rem;color:${COLORS.text};margin:0 0 10px}
    .pp-unlock-message{font-size:1rem;color:#555;line-height:1.5;margin-bottom:20px}
    .pp-print-btn{background:${COLORS.primary};color:#fff;border:none;padding:14px 28px;font-family:'Courier Prime',monospace;font-size:1rem;font-weight:700;border-radius:8px;cursor:pointer;box-shadow:0 4px 12px rgba(232,93,117,.3)}
    .pp-print-btn:hover{background:${COLORS.primaryHover};transform:translateY(-2px)}
    .pp-celebrate{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.85);z-index:100003;display:none;align-items:center;justify-content:center}
    .pp-celebrate.show{display:flex}
    .pp-celebrate-inner{text-align:center;padding:40px}
    .pp-celebrate h2{font-family:'Permanent Marker',cursive;font-size:2.5rem;color:#fff;margin:0 0 15px}
    .pp-celebrate p{font-family:'Courier Prime',monospace;font-size:1.1rem;color:rgba(255,255,255,.9);margin-bottom:30px}
    .pp-celebrate-btn{background:#FFD700;color:${COLORS.text};border:none;padding:15px 30px;font-family:'Permanent Marker',cursive;font-size:1.1rem;border-radius:8px;cursor:pointer;box-shadow:0 4px 20px rgba(255,215,0,.4)}
    .pp-celebrate-btn:hover{transform:scale(1.05)}
    .pp-print{display:none;font-family:'Courier Prime',monospace;max-width:600px;margin:0 auto;padding:40px;background:#fff}
    .pp-print.printing{display:block;position:fixed;top:0;left:0;right:0;bottom:0;z-index:999999;overflow:auto}
    .pp-print-header{text-align:center;margin-bottom:30px;padding-bottom:20px;border-bottom:3px double ${COLORS.text}}
    .pp-print-header h1{font-family:'Permanent Marker',cursive;font-size:2rem;margin:0 0 5px}
    .pp-print-header p{color:${COLORS.textLight};margin:5px 0}
    .pp-print-cert{border:3px solid ${COLORS.text};padding:30px;margin-bottom:30px;text-align:center}
    .pp-print-cert h2{font-family:'Permanent Marker',cursive;font-size:1.3rem;margin:0 0 10px}
    .pp-print-cert p{font-size:.9rem;color:#555;line-height:1.5}
    .pp-print-stickers{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:30px}
    .pp-print-sticker{text-align:center}
    .pp-print-sticker img{width:100%;max-width:120px}
    .pp-print-sticker-name{font-size:.75rem;font-weight:700;text-transform:uppercase;margin-top:8px;color:#333}
    .pp-print-footer{text-align:center;padding-top:20px;border-top:1px dashed ${COLORS.border};font-size:.8rem;color:${COLORS.textMuted}}
    .pp-print-close{position:fixed;top:20px;right:20px;background:${COLORS.primary};color:#fff;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;z-index:1000000}
    @media print{body *{visibility:hidden}.pp-print,.pp-print *{visibility:visible}.pp-print{position:absolute;left:0;top:0;width:100%}.pp-print-close{display:none}}
    @media(max-width:500px){.pp-panel{padding:20px 15px}.pp-book{padding:25px 20px 25px 45px}.pp-title{font-size:1.2rem}.pp-grid{gap:10px}.pp-spiral{left:14px}.pp-ring{width:18px;height:18px}.pp-tab{top:auto;bottom:20px;transform:none}.pp-tab:hover{transform:translateX(-5px)}.pp-quiz-answers{grid-template-columns:1fr}.pp-quiz-box{width:95%;padding:20px}.pp-quiz-question{font-size:1rem}.pp-quiz-answer{font-size:.85rem;padding:12px 12px 12px 38px}}
    .pp-container-hidden{display:none !important}
    `;

    var styleEl = document.createElement('style');
    styleEl.textContent = css;
    document.head.appendChild(styleEl);

    function getCollected() { try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || []; } catch (e) { return []; } }
    function saveCollected(arr) { localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }
    function getLastClaim() { return parseInt(localStorage.getItem(LAST_CLAIM_KEY) || '0', 10); }
    function setLastClaim() { localStorage.setItem(LAST_CLAIM_KEY, Date.now().toString()); }
    function getTimeLeft() { var last = getLastClaim(); if (!last) return 0; var left = (TIME_DELAY_MINUTES * 60 * 1000) - (Date.now() - last); return left > 0 ? left : 0; }
    function formatTime(ms) { var s = Math.ceil(ms / 1000); var m = Math.floor(s / 60); s = s % 60; return m + ':' + (s < 10 ? '0' : '') + s; }

    function playSound(freqs) {
      try {
        var ctx = new (window.AudioContext || window.webkitAudioContext)();
        freqs.forEach(function (f, i) {
          var o = ctx.createOscillator(), g = ctx.createGain();
          o.connect(g); g.connect(ctx.destination);
          o.frequency.value = f;
          var t = ctx.currentTime + i * 0.12;
          g.gain.setValueAtTime(0, t);
          g.gain.linearRampToValueAtTime(0.25, t + 0.05);
          g.gain.exponentialRampToValueAtTime(0.01, t + 0.3);
          o.start(t); o.stop(t + 0.3);
        });
      } catch (e) { }
    }

    function confetti(container) {
      container.innerHTML = '';
      var colors = [COLORS.primary, COLORS.success, '#FFD700', '#00BCD4', '#9C27B0'];
      for (var i = 0; i < 30; i++) {
        var c = document.createElement('div');
        c.className = 'pp-confetti-piece';
        c.style.cssText = 'left:' + Math.random() * 100 + '%;top:-10px;width:' + (4 + Math.random() * 6) + 'px;height:' + (4 + Math.random() * 6) + 'px;background:' + colors[Math.floor(Math.random() * colors.length)] + ';border-radius:' + (Math.random() > 0.5 ? '50%' : '2px') + ';animation:confettiFall ' + (0.6 + Math.random() * 0.4) + 's ease-out ' + Math.random() * 0.2 + 's forwards';
        container.appendChild(c);
      }
    }

    function openQuiz(sticker) {
      currentQuizSticker = sticker;
      var modal = document.getElementById('ppQuiz');
      document.getElementById('ppQuizQuestion').textContent = sticker.quiz.question;
      document.getElementById('ppQuizFeedback').className = 'pp-quiz-feedback';
      var ans = document.getElementById('ppQuizAnswers');
      ans.innerHTML = '';
      ['a', 'b', 'c', 'd'].forEach(function (l) {
        if (sticker.quiz.answers[l]) {
          var btn = document.createElement('button');
          btn.className = 'pp-quiz-answer';
          btn.innerHTML = '<span class="pp-quiz-letter">' + l.toUpperCase() + '</span>' + sticker.quiz.answers[l];
          btn.onclick = function () { handleAnswer(l, btn); };
          ans.appendChild(btn);
        }
      });
      modal.classList.add('open');
    }

    function closeQuiz() {
      document.getElementById('ppQuiz').classList.remove('open');
      currentQuizSticker = null;
    }

    function handleAnswer(letter, btn) {
      if (!currentQuizSticker) return;
      var btns = document.querySelectorAll('.pp-quiz-answer');
      var fb = document.getElementById('ppQuizFeedback');
      btns.forEach(function (b) { b.style.pointerEvents = 'none'; });
      if (letter === currentQuizSticker.quiz.correctAnswer) {
        btn.classList.add('correct');
        playSound([523.25, 659.25, 783.99]);
        confetti(document.getElementById('ppQuizConfetti'));
        fb.textContent = 'üéâ Correct! Sticker unlocked!';
        fb.className = 'pp-quiz-feedback correct show';
        var col = getCollected();
        col.push(currentQuizSticker.id);
        saveCollected(col);
        setLastClaim();
        setTimeout(function () {
          closeQuiz();
          render();
          updateBadge();
          if (col.length === STICKERS.length && !localStorage.getItem(CELEBRATED_KEY)) {
            setTimeout(showCelebrate, 500);
          }
        }, 1400);
      } else {
        btn.classList.add('incorrect');
        playSound([200]);
        fb.textContent = 'üòê Not quite‚Äîtry again!';
        fb.className = 'pp-quiz-feedback incorrect show';
        setTimeout(function () {
          btns.forEach(function (b) { b.style.pointerEvents = 'auto'; b.classList.remove('incorrect'); });
          fb.className = 'pp-quiz-feedback';
        }, 900);
      }
    }

    function openPanel() { document.getElementById('ppOverlay').classList.add('open'); render(); document.body.style.overflow = 'hidden'; }
    function closePanel() { document.getElementById('ppOverlay').classList.remove('open'); document.body.style.overflow = ''; }
    function showCelebrate() { playSound([523.25, 659.25, 783.99, 1046.5]); document.getElementById('ppCelebrate').classList.add('show'); localStorage.setItem(CELEBRATED_KEY, 'true'); }
    function closeCelebrate() { document.getElementById('ppCelebrate').classList.remove('show'); render(); }

    function printCert() {
      var p = document.getElementById('ppPrint');
      document.getElementById('ppPrintDate').textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
      var grid = document.getElementById('ppPrintStickers');
      grid.innerHTML = '';
      STICKERS.forEach(function (s) { grid.innerHTML += '<div class="pp-print-sticker"><img src="' + s.image + '" alt="' + s.name + '"><div class="pp-print-sticker-name">' + s.name + '</div></div>'; });
      p.classList.add('printing');
      document.body.style.overflow = 'hidden';
      setTimeout(function () { window.print(); }, 300);
    }
    function closePrint() { document.getElementById('ppPrint').classList.remove('printing'); document.body.style.overflow = ''; }

    function render() {
      var grid = document.getElementById('ppGrid');
      var cooldown = document.getElementById('ppCooldown');
      var collected = getCollected();
      var timeLeft = getTimeLeft();
      var isOnCooldown = timeLeft > 0 && collected.length > 0 && collected.length < STICKERS.length;
      if (cooldown) { cooldown.style.display = isOnCooldown ? 'block' : 'none'; cooldown.textContent = 'Next sticker in: ' + formatTime(timeLeft); }
      grid.innerHTML = '';
      STICKERS.forEach(function (s, index) {
        var slot = document.createElement('div');
        slot.className = 'pp-slot';
        var isCollected = collected.indexOf(s.id) !== -1;
        var isNext = index === collected.length;
        if (isCollected) {
          slot.classList.add('collected');
          slot.innerHTML = '<div class="pp-box"><img src="' + s.image + '" alt="' + s.name + '"></div><span class="pp-label">' + s.name + '</span>';
        } else if (isOnCooldown) {
          slot.classList.add('empty', 'locked');
          slot.innerHTML = '<div class="pp-box"><div class="pp-box-inner"><span class="pp-box-icon">‚è≥</span><span class="pp-box-text">Wait...</span></div></div><span class="pp-label">' + s.name + '</span>';
        } else if (isNext) {
          slot.classList.add('empty');
          slot.innerHTML = '<div class="pp-box"><div class="pp-box-inner"><span class="pp-box-icon">üèÜ</span><span class="pp-box-text">Prove it!</span></div></div><span class="pp-label">' + s.name + '</span>';
          slot.querySelector('.pp-box').onclick = function () { openQuiz(s); };
        } else {
          slot.classList.add('empty', 'locked');
          slot.innerHTML = '<div class="pp-box"><div class="pp-box-inner"><span class="pp-box-icon">üîí</span><span class="pp-box-text">Complete previous</span></div></div><span class="pp-label">' + s.name + '</span>';
        }
        grid.appendChild(slot);
      });
      document.getElementById('ppCollected').textContent = collected.length;
      document.getElementById('ppTotal').textContent = STICKERS.length;
      document.getElementById('ppBook').classList.toggle('all-collected', collected.length === STICKERS.length);
      if (isOnCooldown && !cooldownTimer) {
        cooldownTimer = setInterval(function () {
          var left = getTimeLeft();
          if (left <= 0) { clearInterval(cooldownTimer); cooldownTimer = null; render(); }
          else if (cooldown) cooldown.textContent = 'Next sticker in: ' + formatTime(left);
        }, 1000);
      }
    }

    function updateBadge() {
      var collected = getCollected();
      var badge = document.getElementById('ppBadge');
      if (badge) { badge.classList.toggle('complete', collected.length === STICKERS.length); badge.textContent = collected.length === STICKERS.length ? '‚úì' : collected.length + '/' + STICKERS.length; }
    }

    function isTargetLesson() {
      if (!TARGET_LESSON) return true;
      if (document.title && document.title.indexOf(TARGET_LESSON) !== -1) return true;
      var h1s = document.querySelectorAll('h1');
      for (var i = 0; i < h1s.length; i++) { if (h1s[i].innerText && h1s[i].innerText.indexOf(TARGET_LESSON) !== -1) return true; }
      return false;
    }

    function updateVisibility() {
      var container = document.getElementById('ppContainer');
      if (!container) return;
      if (isTargetLesson()) { container.classList.remove('pp-container-hidden'); } else { container.classList.add('pp-container-hidden'); closePanel(); closeQuiz(); }
    }

    function init() {
      if (document.getElementById('ppContainer')) return;
      var spiralRings = '';
      for (var i = 0; i < 6; i++) { spiralRings += '<div class="pp-ring"></div>'; }
      var c = document.createElement('div');
      c.id = 'ppContainer';
      c.innerHTML =
        '<div class="pp-tab" id="ppTab"><div class="pp-tab-inner"><span class="pp-tab-icon">üìì</span><span class="pp-tab-text">' + BRANDING.tabText + '</span><span class="pp-tab-badge" id="ppBadge">0/' + STICKERS.length + '</span></div></div>' +
        '<div class="pp-overlay" id="ppOverlay"><div class="pp-panel"><div class="pp-panel-edge"></div>' +
        '<div class="pp-book" id="ppBook"><div class="pp-complete-badge">' + BRANDING.completeBadge + '</div>' +
        '<div class="pp-spiral">' + spiralRings + '</div>' +
        '<span class="pp-doodle pp-doodle-1">‚ú¶</span><span class="pp-doodle pp-doodle-2">‚òÖ</span><span class="pp-doodle pp-doodle-3">‚úß</span>' +
        '<div class="pp-header"><h1 class="pp-title">' + BRANDING.bookTitle + '</h1><p class="pp-subtitle">' + BRANDING.bookSubtitle + '</p><p class="pp-instructions">' + BRANDING.instructions + '</p><p class="pp-progress"><span id="ppCollected">0</span> of <span id="ppTotal">' + STICKERS.length + '</span> collected</p></div>' +
        '<div class="pp-grid" id="ppGrid"></div>' +
        '<div class="pp-footer"><p class="pp-footer-text">' + BRANDING.footerText + '</p><p class="pp-cooldown" id="ppCooldown"></p></div>' +
        '<div class="pp-unlock"><div class="pp-unlock-divider"><span>‚ú¶ SECRET UNLOCKED ‚ú¶</span></div><div class="pp-unlock-content"><h2 class="pp-unlock-title">' + BRANDING.unlockTitle + '</h2><p class="pp-unlock-message">' + BRANDING.unlockMessage + '</p><button class="pp-print-btn" id="ppPrintBtn">üñ® Print My Collection</button></div></div>' +
        '</div><button class="pp-close" id="ppCloseBtn">√ó Close</button></div></div>' +
        '<div class="pp-quiz" id="ppQuiz"><div class="pp-quiz-box"><div class="pp-confetti" id="ppQuizConfetti"></div><button class="pp-quiz-close" id="ppQuizClose">√ó</button><p class="pp-quiz-instruction">Tap the answer you think is correct</p><div class="pp-quiz-question" id="ppQuizQuestion"></div><div class="pp-quiz-answers" id="ppQuizAnswers"></div><div class="pp-quiz-feedback" id="ppQuizFeedback"></div></div></div>' +
        '<div class="pp-celebrate" id="ppCelebrate"><div class="pp-celebrate-inner"><h2>Collection Complete!</h2><p>You\'ve unlocked something special‚Ä¶</p><button class="pp-celebrate-btn" id="ppCelebrateBtn">See My Reward ‚Üí</button></div></div>' +
        '<div class="pp-print" id="ppPrint"><button class="pp-print-close" id="ppPrintClose">√ó Close</button><div class="pp-print-header"><h1>' + BRANDING.bookSubtitle + '</h1><p>' + BRANDING.certificateTitle + '</p><p id="ppPrintDate"></p></div><div class="pp-print-cert"><h2>' + BRANDING.certificateTitle + '</h2><p>' + BRANDING.certificateText + '</p></div><div class="pp-print-stickers" id="ppPrintStickers"></div><div class="pp-print-footer"><p>' + BRANDING.certificateFooter + '</p></div></div>';
      document.body.appendChild(c);
      document.getElementById('ppTab').onclick = openPanel;
      document.getElementById('ppOverlay').onclick = function (e) { if (e.target === this) closePanel(); };
      document.getElementById('ppCloseBtn').onclick = closePanel;
      document.getElementById('ppQuizClose').onclick = closeQuiz;
      document.getElementById('ppQuiz').onclick = function (e) { if (e.target === this) closeQuiz(); };
      document.getElementById('ppCelebrateBtn').onclick = closeCelebrate;
      document.getElementById('ppPrintBtn').onclick = printCert;
      document.getElementById('ppPrintClose').onclick = closePrint;
      document.addEventListener('keydown', function (e) { if (e.key === 'Escape') { closeQuiz(); closePanel(); closePrint(); } });
      updateBadge();
      updateVisibility();
    }

    if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', init); } else { init(); }
    setInterval(function() { var container = document.getElementById('ppContainer'); if (container) { updateVisibility(); } else { init(); } }, 500);
    window.resetStickerBook = function () { localStorage.removeItem(STORAGE_KEY); localStorage.removeItem(CELEBRATED_KEY); localStorage.removeItem(LAST_CLAIM_KEY); if (cooldownTimer) { clearInterval(cooldownTimer); cooldownTimer = null; } render(); updateBadge(); console.log('Sticker book reset!'); };
    })();
    </script>
</body>
</html>
